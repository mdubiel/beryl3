# Beryl3 Django Application Environment Configuration
# Generated by Ansible for {{ app_domain }}

# Django Core Settings
SECRET_KEY={{ vault_django_secret_key | default('django-insecure-staging-key-change-in-production') }}
DEBUG=True
ALLOWED_HOSTS={{ app_domain }},{{ ansible_host }},localhost,127.0.0.1,vhost.example.com
CSRF_TRUSTED_ORIGINS=https://{{ app_domain }},http://{{ ansible_host }}:8000

# Database Configuration
DATABASE_URL=postgres://{{ postgres_user }}:{{ postgres_password }}@beryl3-postgres:5432/{{ postgres_db }}
PG_HOST=beryl3-postgres
PG_PORT=5432
PG_DB={{ postgres_db }}
PG_USER={{ postgres_user }}
PG_PASSWORD={{ postgres_password }}

# Email Configuration (Resend for staging)
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.resend.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_USE_SSL=False
EMAIL_HOST_USER=resend
EMAIL_HOST_PASSWORD={{ resend_api_key }}
DEFAULT_FROM_EMAIL=noreply@send.beryl3.com

# Media and Static Files Configuration 
# Using Google Cloud Storage for both media and static files
MEDIA_URL=https://storage.googleapis.com/beryl3_dev/media/
STATIC_URL=https://storage.googleapis.com/beryl3_dev/static/
MEDIA_ROOT=/app/media
STATIC_ROOT=/app/staticfiles

# Storage Configuration (using GCS for staging)
USE_GCS_STORAGE=True
GCS_BUCKET_NAME=beryl3_dev
GCS_PROJECT_ID=mateusz-344213
GCS_CREDENTIALS_PATH=/app/gcs-credentials.json
GCS_LOCATION=media

# Security Settings
SECURE_BROWSER_XSS_FILTER=True
SECURE_CONTENT_TYPE_NOSNIFF=True
X_FRAME_OPTIONS=DENY
CSRF_COOKIE_SECURE=True
CSRF_COOKIE_HTTPONLY=False
SESSION_COOKIE_SECURE=True

# Application Settings
SITE_NAME=Beryl3 Staging
SITE_URL=https://{{ app_domain }}

# Optional Superuser Creation (for first run)
DJANGO_SUPERUSER_EMAIL=admin@{{ app_domain }}
DJANGO_SUPERUSER_PASSWORD={{ vault_django_admin_password | default('admin123') }}

# Logging Configuration
LOG_LEVEL=INFO

# Loki Integration (forward all logs to Loki)
LOKI_ENABLED=True
LOKI_URL=http://loki:3100

# Environment for log tagging
SENTRY_ENVIRONMENT=staging

# External Service URLs (for SYS admin panel) - Using proper subdomains
EXTERNAL_DB_URL=https://adminer.staging.mdubiel.org
EXTERNAL_GRAFANA_URL=https://grafana.staging.mdubiel.org
EXTERNAL_LOKI_URL=https://loki.staging.mdubiel.org
EXTERNAL_MONITORING_URL=https://prometheus.staging.mdubiel.org
EXTERNAL_REGISTRY_URL=https://registry.staging.mdubiel.org
EXTERNAL_INBUCKET_URL=
EXTERNAL_SENTRY_URL=
EXTERNAL_RESEND_URL=https://resend.com/dashboard

# Site Domain Configuration
SITE_DOMAIN={{ beryl3_app.domain | default('beryl3.staging.mdubiel.org') }}